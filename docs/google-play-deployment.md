# Google Play配布ガイド

## 目次

1. [事前準備](#事前準備)
2. [Google Play Consoleの設定](#google-play-consoleの設定)
3. [アプリのビルド](#アプリのビルド)
4. [リリースの作成](#リリースの作成)
5. [レビューと公開](#レビューと公開)
6. [リリース後の管理](#リリース後の管理)

---

## 事前準備

### 1. 必要なアカウント

- [ ] Googleアカウント
- [ ] Google Play Console開発者アカウント（$25の初回登録料）
- [ ] Expoアカウント（EAS Buildを使用する場合）

### 2. 必要な情報とファイル

- [ ] アプリ名: 「なんでもカウンター」
- [ ] パッケージ名: `com.nandemocounter`
- [ ] アプリアイコン（1024x1024px）
- [ ] 機能グラフィック（1024x500px、オプション）
- [ ] スクリーンショット（2枚以上、最大8枚）
- [ ] アプリの説明文（日本語）
- [ ] プライバシーポリシーのURL

---

## Google Play Consoleの設定

### 1. 開発者アカウントの作成

1. [Google Play Console](https://play.google.com/console/)にアクセス
2. Googleアカウントでログイン
3. 「開発者として登録」をクリック
4. 開発者情報を入力：
   - 開発者名
   - メールアドレス
   - 電話番号
   - 支払い情報（$25の初回登録料）
5. 利用規約に同意
6. 支払いを完了

### 2. アプリの作成

1. Google Play Consoleのダッシュボードで「アプリを作成」をクリック
2. アプリの詳細を入力：
   - **アプリ名**: なんでもカウンター
   - **デフォルト言語**: 日本語
   - **アプリまたはゲーム**: アプリ
   - **無料または有料**: 無料
   - **デフォルトの配布国**: 日本（必要に応じて追加）
3. 「アプリを作成」をクリック

### 3. ストア掲載情報の設定

#### アプリの説明

**日本語版**:
```
なんでもカウンターは、何でも数えて記録できるシンプルなカウンターアプリです。

【主な機能】
・会員登録なしで即座に利用開始
・タグ機能による柔軟な分類
・ボタン操作と直接入力の2種類の入力方法
・位置情報の記録（オプション）
・タグ別の統計とグラフ表示
・カレンダーでの記録可視化

【使い方】
1. カウンターを作成
2. カウント操作（+/-ボタンまたは直接入力）
3. タグを付けて分類
4. 分析画面で統計を確認

会員登録不要で、すぐに使い始められます。
```

#### スクリーンショットの準備

**必要なサイズ**:
- **電話**: 16:9または9:16（最小320px、最大3840px）
- **7インチタブレット**: 16:9または9:16（オプション）
- **10インチタブレット**: 16:9または9:16（オプション）

**推奨スクリーンショット**:
1. メイン画面（カウンター一覧）
2. カウント登録画面
3. カウンター詳細画面
4. タグ分析画面（カレンダー）
5. タグ分析画面（グラフ）
6. 履歴画面

**スクリーンショットの撮影方法**:
```bash
# Androidエミュレータでアプリを起動
cd app
npm run android

# 各画面でスクリーンショットを撮影
# または、Expo Goで実機でスクリーンショットを撮影
```

#### アプリアイコン

**ファイル**: `app/assets/icon.png`

- **サイズ**: 1024x1024px
- **形式**: PNG（透明背景可）
- **内容**: アプリを表すアイコン

#### 機能グラフィック（オプション）

- **サイズ**: 1024x500px
- **形式**: PNGまたはJPG
- **内容**: アプリの主要機能を紹介

### 4. コンテンツレーティング

1. 「コンテンツレーティング」セクションに移動
2. 「質問に回答」をクリック
3. 以下の質問に回答：
   - **位置情報**: はい（ユーザーが許可した場合のみ）
   - **広告**: はい（Google AdMobを使用）
   - **その他のデータ収集**: いいえ（ローカルストレージのみ）
4. レーティングを取得（通常は「3+」または「Everyone」）

### 5. プライバシーポリシー

1. プライバシーポリシーをWebサイトに公開（GitHub Pages推奨）
2. Google Play Consoleの「プライバシーポリシー」セクションにURLを入力

**例**: `https://your-username.github.io/nandemo-counter-privacy-policy/`

### 6. データの安全性

1. 「データの安全性」セクションに移動
2. 以下の情報を入力：

**データの収集**:
- **位置情報**: 
  - 収集: はい
  - 用途: アプリ機能
  - 必須: いいえ（オプション）
  - 共有: いいえ

**データの共有**:
- データを第三者と共有: いいえ

**データのセキュリティ**:
- データの暗号化: いいえ（ローカルストレージのみ）

### 7. ターゲットオーディエンスとコンテンツ

- **ターゲットオーディエンス**: すべての年齢
- **コンテンツレーティング**: 取得したレーティングを設定

### 8. 価格と配布

- **価格**: 無料
- **国・地域**: 配布する国を選択（日本を含む）

---

## アプリのビルド

### 1. EAS Buildの設定

#### EAS CLIのインストール

```bash
npm install -g eas-cli
```

#### EASにログイン

```bash
eas login
```

#### プロジェクトの設定

```bash
cd app
eas build:configure
```

これにより`eas.json`が作成されます。

### 2. eas.jsonの設定

**ファイル**: `app/eas.json`

```json
{
  "cli": {
    "version": ">= 5.0.0"
  },
  "build": {
    "development": {
      "developmentClient": true,
      "distribution": "internal"
    },
    "preview": {
      "distribution": "internal",
      "android": {
        "buildType": "apk"
      }
    },
    "production": {
      "android": {
        "buildType": "app-bundle"
      }
    }
  },
  "submit": {
    "production": {
      "android": {
        "serviceAccountKeyPath": "./google-play-service-account.json",
        "track": "internal"
      }
    }
  }
}
```

### 3. app.jsonの設定確認

**ファイル**: `app/app.json`

```json
{
  "expo": {
    "name": "なんでもカウンター",
    "slug": "nandemo-counter",
    "version": "1.0.0",
    "android": {
      "package": "com.nandemocounter",
      "versionCode": 1,
      "adaptiveIcon": {
        "foregroundImage": "./assets/adaptive-icon.png",
        "backgroundColor": "#ffffff"
      },
      "permissions": [
        "ACCESS_FINE_LOCATION",
        "ACCESS_COARSE_LOCATION"
      ]
    },
    "extra": {
      "eas": {
        "projectId": "your-project-id"
      }
    }
  }
}
```

**重要**: 
- `versionCode`は各リリースで増やす必要があります
- `version`はユーザーに表示されるバージョン番号

### 4. 本番ビルドの実行

```bash
cd app
eas build --platform android --profile production
```

ビルドには10-20分かかります。完了すると、ダウンロードリンクが表示されます。

### 5. ビルドの確認

- [ ] ビルドが成功している
- [ ] アプリバンドル（.aab）がダウンロードできる
- [ ] バージョン番号が正しい

---

## リリースの作成

### 1. 内部テスト

#### 内部テストの作成

1. Google Play Consoleで「リリース」→「内部テスト」を選択
2. 「リリースを作成」をクリック
3. アプリバンドル（.aab）をアップロード
4. リリース名: `1.0.0 (1)`（バージョン名とバージョンコード）
5. リリースノート（オプション）:
   ```
   初回リリース
   - カウンター機能
   - タグ機能
   - 分析機能
   ```
6. 「レビュー」をクリック

#### テストユーザーの追加

1. 「テスト担当者」タブを選択
2. 「メールアドレスリストを作成」をクリック
3. テストユーザーのメールアドレスを追加
4. 「変更を保存」をクリック

### 2. クローズドテスト（オプション）

1. 「リリース」→「クローズドテスト」を選択
2. 内部テストと同様の手順でリリースを作成
3. テストユーザーを招待

### 3. オープンテスト（オプション）

1. 「リリース」→「オープンテスト」を選択
2. 一般ユーザーが参加可能なテストリリースを作成

### 4. 本番リリース

1. 「リリース」→「本番環境」を選択
2. 「リリースを作成」をクリック
3. アプリバンドル（.aab）をアップロード
4. リリース名: `1.0.0 (1)`
5. リリースノート:
   ```
   【初回リリース】
   
   なんでもカウンターアプリの初回リリースです。
   
   【主な機能】
   - カウンターの作成・管理
   - タグ機能による分類
   - 統計とグラフ表示
   - 位置情報の記録（オプション）
   
   会員登録不要で、すぐに使い始められます。
   ```
6. 「レビュー」をクリック

---

## レビューと公開

### 1. レビューの送信

1. すべての必須項目が完了していることを確認
2. 「レビューを送信」をクリック
3. レビューには通常1-3営業日かかります

### 2. レビュー中の確認事項

- [ ] すべての必須項目が完了している
- [ ] プライバシーポリシーが公開されている
- [ ] コンテンツレーティングが取得されている
- [ ] データの安全性が記入されている

### 3. レビュー結果の確認

- **承認**: アプリが公開されます
- **却下**: 却下理由を確認し、修正して再提出

### 4. 公開後の確認

- [ ] Google Playストアでアプリが検索できる
- [ ] アプリが正常にインストールできる
- [ ] すべての機能が正常に動作する

---

## リリース後の管理

### 1. バージョンアップの手順

#### バージョン番号の更新

**ファイル**: `app/app.json`

```json
{
  "expo": {
    "version": "1.0.1",  // ユーザーに表示されるバージョン
    "android": {
      "versionCode": 2  // 各リリースで1ずつ増やす
    }
  }
}
```

#### 新しいビルドの作成

```bash
cd app
eas build --platform android --profile production
```

#### 新しいリリースの作成

1. Google Play Consoleで「リリース」→「本番環境」を選択
2. 新しいバージョンのリリースを作成
3. リリースノートに変更内容を記載

### 2. アプリの分析

Google Play Consoleの「統計情報」セクションで以下を確認：

- インストール数
- アンインストール数
- クラッシュとANR（アプリの応答なし）
- ユーザーレビューと評価

### 3. ユーザーレビューへの対応

- 定期的にレビューを確認
- 問題があれば修正してアップデート
- ポジティブなレビューには感謝の返信

### 4. アプリの更新

重要なバグ修正や新機能追加時は、できるだけ早くアップデートをリリースします。

---

## トラブルシューティング

### ビルドエラー

**問題**: EAS Buildでエラーが発生する

**解決策**:
1. `eas.json`の設定を確認
2. `app.json`の設定を確認
3. 依存パッケージのバージョンを確認
4. EAS CLIを最新版に更新: `npm install -g eas-cli@latest`

### アップロードエラー

**問題**: アプリバンドルをアップロードできない

**解決策**:
1. ファイルサイズを確認（150MB以下）
2. バージョンコードが既存のものより大きいか確認
3. パッケージ名が正しいか確認

### レビュー却下

**問題**: アプリがレビューで却下された

**解決策**:
1. 却下理由を確認
2. 必要な修正を行う
3. 修正版を再提出

---

## チェックリスト

### リリース前

- [ ] アプリが正常に動作する
- [ ] 広告が表示される（テスト広告でOK）
- [ ] 位置情報の許可リクエストが表示される
- [ ] すべての画面が正常に動作する
- [ ] エラーハンドリングが適切に実装されている

### Google Play Console

- [ ] 開発者アカウントが作成されている
- [ ] アプリが作成されている
- [ ] ストア掲載情報が入力されている
- [ ] スクリーンショットがアップロードされている
- [ ] アプリアイコンが設定されている
- [ ] プライバシーポリシーが公開されている
- [ ] コンテンツレーティングが取得されている
- [ ] データの安全性が記入されている

### ビルドと配布

- [ ] 本番ビルドが成功している
- [ ] アプリバンドル（.aab）が生成されている
- [ ] 内部テストで動作確認が完了している
- [ ] リリースノートが作成されている
- [ ] レビューが送信されている

---

## 参考資料

- [Google Play Console ヘルプ](https://support.google.com/googleplay/android-developer)
- [EAS Build ドキュメント](https://docs.expo.dev/build/introduction/)
- [Expo 公式ドキュメント](https://docs.expo.dev/)
- [Android App Bundle ガイド](https://developer.android.com/guide/app-bundle)
